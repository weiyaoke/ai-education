15:46:32.312-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown stop
15:46:32.313-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
15:46:32.313-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
15:46:32.313-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown stop
15:46:32.315-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown begin
15:46:32.315-[DESKTOP-FSAK1AQ][sys]-- WARN 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Start destroying NacosRestTemplate
15:46:32.315-[DESKTOP-FSAK1AQ][sys]-- WARN 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Destruction of the end
15:46:32.315-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] c.a.n.client.identify.CredentialWatcher  : [null] CredentialWatcher is stopped
15:46:32.315-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] c.a.n.client.identify.CredentialService  : [null] CredentialService is freed
15:46:32.315-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown stop
15:46:32.336-[DESKTOP-FSAK1AQ][sys]-- INFO 38312 --- [ionShutdownHook] o.s.a.r.l.SimpleMessageListenerContainer : Shutdown ignored - container is already stopped
15:46:45.437-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.tianji.promotion.PromotionApplication  : The following 1 profile is active: "local"
15:46:45.838-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:46:45.839-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:46:45.850-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
15:46:45.970-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=2a5e96f4-55e3-3f97-bb3d-bfd0bc68bfd7
15:46:46.097-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:46:46.099-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:46:46.100-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$663/0x0000000800601040] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:46:46.102-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:46:46.115-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.cloud.sentinel-com.alibaba.cloud.sentinel.SentinelProperties' of type [com.alibaba.cloud.sentinel.SentinelProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:46:46.117-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration' of type [com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:46:46.226-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8091 (http)
15:46:46.230-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:46:46.230-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
15:46:46.292-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:46:46.293-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 848 ms
15:46:47.362-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:46:47.560-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [           main] c.t.c.a.redisson.RedissonConfig          : 尝试初始化RedissonClient
15:46:47.583-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] org.redisson.Version                     : Redisson 3.13.6
15:46:47.793-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [sson-netty-4-20] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for /192.168.150.101:6379
15:46:47.806-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [sson-netty-4-14] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for /192.168.150.101:6379
15:46:47.922-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.c.sentinel.SentinelWebMvcConfigurer  : [Sentinel Starter] register SentinelWebInterceptor with urlPatterns: [/**].
15:46:48.127-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'auth-service' URL not provided. Will try picking an instance via load-balancing.
15:46:48.153-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config init.
15:46:48.153-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config end.
15:46:49.449-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
15:46:49.538-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:stopSendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@a49cdd6[class com.tianji.promotion.handler.SendCouponHandler#stopSendCouponByTime]
15:46:49.538-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:sendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@109a462e[class com.tianji.promotion.handler.SendCouponHandler#sendCouponByTime]
15:46:49.555-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.564-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.572-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.579-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'exam-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.587-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'learning-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.594-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'remark-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.599-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'search-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.605-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'trade-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.612-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'user-service' URL not provided. Will try picking an instance via load-balancing.
15:46:49.654-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 9999
15:46:49.695-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
15:46:49.696-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Environment :null
15:46:49.696-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
15:46:49.719-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8091 (http) with context path ''
15:46:49.721-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
15:46:49.721-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] com.alibaba.nacos.client.naming          : [REGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 registering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={preserved.register.source=SPRING_CLOUD}}
15:46:49.723-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP promotion-service 192.168.150.1:8091 register finished
15:46:50.237-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580010252,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":12439194936301} from /192.168.150.101
15:46:50.243-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [g.push.receiver] com.alibaba.nacos.client.naming          : new ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
15:46:50.251-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
15:46:50.899-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
15:46:51.053-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.150.101:5672]
15:46:51.072-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Created new connection: rabbitConnectionFactory#c555e1e:0/SimpleConnection@56d9ef05 [delegate=amqp://tjxt@192.168.150.101:5672//tjxt, localPort= 59430]
15:46:51.104-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.tianji.promotion.PromotionApplication  : Started PromotionApplication in 8.556 seconds (JVM running for 8.99)
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service-local.yaml+DEFAULT_GROUP
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service-local.yaml, group=DEFAULT_GROUP, cnt=1
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service-local.yaml, group=DEFAULT_GROUP
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service+DEFAULT_GROUP
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service, group=DEFAULT_GROUP, cnt=1
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service, group=DEFAULT_GROUP
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service.yaml+DEFAULT_GROUP
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service.yaml, group=DEFAULT_GROUP, cnt=1
15:46:51.106-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service.yaml, group=DEFAULT_GROUP
15:46:51.107-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [           main] c.tianji.promotion.PromotionApplication  : --/
---------------------------------------------------------------------------------------
	Application 'promotion-service' is running! Access URLs:
	Local: 		http://localhost:8091
	External: 	http://192.168.150.1:8091
	Profile(s): 	[local]
---------------------------------------------------------------------------------------
15:47:19.872-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [nio-8091-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
15:47:19.872-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [nio-8091-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
15:47:19.873-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [nio-8091-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
15:47:20.013-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]-- INFO 33440 --- [nio-8091-exec-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
15:47:20.138-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]-- INFO 33440 --- [nio-8091-exec-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
15:47:20.142-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]--DEBUG 33440 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectPage_mpCount  : ==>  Preparing: SELECT COUNT(*) FROM coupon
15:47:20.154-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]--DEBUG 33440 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectPage_mpCount  : ==> Parameters: 
15:47:20.165-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]--DEBUG 33440 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectPage_mpCount  : <==      Total: 1
15:47:20.171-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]--DEBUG 33440 --- [nio-8091-exec-1] c.t.p.mapper.CouponMapper.selectPage     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon ORDER BY create_time DESC LIMIT ?
15:47:20.172-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]--DEBUG 33440 --- [nio-8091-exec-1] c.t.p.mapper.CouponMapper.selectPage     : ==> Parameters: 10(Long)
15:47:20.179-[DESKTOP-FSAK1AQ][b5457d6faa374e8bb600b8a57fd69d97]--DEBUG 33440 --- [nio-8091-exec-1] c.t.p.mapper.CouponMapper.selectPage     : <==      Total: 9
15:47:51.366-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]-- INFO 33440 --- [nio-8091-exec-2] c.tianji.common.validate.EnumValidator   : payload>>[]
15:47:51.367-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]-- INFO 33440 --- [nio-8091-exec-2] c.tianji.common.validate.EnumValidator   : payload>>[]
15:47:51.379-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.mapper.CouponMapper.insert         : ==>  Preparing: INSERT INTO coupon ( id, `name`, discount_type, `specific`, discount_value, threshold_amount, max_discount_amount, obtain_way, total_num, user_limit, creater, updater ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )
15:47:51.380-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.mapper.CouponMapper.insert         : ==> Parameters: 1907339178157277186(Long), 911大促销(String), 4(Integer), true(Boolean), 5000(Integer), 10000(Integer), 0(Integer), 2(Integer), 100(Integer), 1(Integer), 1(Long), 1(Long)
15:47:51.381-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.mapper.CouponMapper.insert         : <==    Updates: 1
15:47:51.388-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.mapper.CouponScopeMapper.insert    : ==>  Preparing: INSERT INTO coupon_scope ( type, coupon_id, biz_id ) VALUES ( ?, ?, ? )
15:47:51.388-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.mapper.CouponScopeMapper.insert    : ==> Parameters: 1(Integer), 1907339178157277186(Long), 3615(Long)
15:47:51.388-[DESKTOP-FSAK1AQ][7228add31dc046428401316629b0c3ff]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.mapper.CouponScopeMapper.insert    : ==> Parameters: 1(Integer), 1907339178157277186(Long), 3614(Long)
15:47:51.428-[DESKTOP-FSAK1AQ][3fced1b21e6d4b36a651026af7c62a1b]--DEBUG 33440 --- [nio-8091-exec-3] c.t.p.m.CouponMapper.selectPage_mpCount  : ==>  Preparing: SELECT COUNT(*) FROM coupon
15:47:51.428-[DESKTOP-FSAK1AQ][3fced1b21e6d4b36a651026af7c62a1b]--DEBUG 33440 --- [nio-8091-exec-3] c.t.p.m.CouponMapper.selectPage_mpCount  : ==> Parameters: 
15:47:51.430-[DESKTOP-FSAK1AQ][3fced1b21e6d4b36a651026af7c62a1b]--DEBUG 33440 --- [nio-8091-exec-3] c.t.p.m.CouponMapper.selectPage_mpCount  : <==      Total: 1
15:47:51.430-[DESKTOP-FSAK1AQ][3fced1b21e6d4b36a651026af7c62a1b]--DEBUG 33440 --- [nio-8091-exec-3] c.t.p.mapper.CouponMapper.selectPage     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon ORDER BY create_time DESC LIMIT ?
15:47:51.431-[DESKTOP-FSAK1AQ][3fced1b21e6d4b36a651026af7c62a1b]--DEBUG 33440 --- [nio-8091-exec-3] c.t.p.mapper.CouponMapper.selectPage     : ==> Parameters: 10(Long)
15:47:51.436-[DESKTOP-FSAK1AQ][3fced1b21e6d4b36a651026af7c62a1b]--DEBUG 33440 --- [nio-8091-exec-3] c.t.p.mapper.CouponMapper.selectPage     : <==      Total: 10
15:48:11.369-[DESKTOP-FSAK1AQ][8a6e311670984b24aec96002bfc0ff03]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
15:48:11.369-[DESKTOP-FSAK1AQ][8a6e311670984b24aec96002bfc0ff03]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
15:48:11.371-[DESKTOP-FSAK1AQ][8a6e311670984b24aec96002bfc0ff03]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
15:48:11.379-[DESKTOP-FSAK1AQ][8a6e311670984b24aec96002bfc0ff03]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.mapper.CouponMapper.updateById     : ==>  Preparing: UPDATE coupon SET issue_begin_time=?, issue_end_time=?, term_days=?, status=? WHERE id=?
15:48:11.380-[DESKTOP-FSAK1AQ][8a6e311670984b24aec96002bfc0ff03]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.mapper.CouponMapper.updateById     : ==> Parameters: 2025-04-02T15:48:11.371024700(LocalDateTime), 2025-04-30T23:59:59(LocalDateTime), 10(Integer), 3(Integer), 1907339178157277186(Long)
15:48:11.381-[DESKTOP-FSAK1AQ][8a6e311670984b24aec96002bfc0ff03]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.mapper.CouponMapper.updateById     : <==    Updates: 1
15:48:11.526-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [-code-handler-1] c.t.p.s.impl.ExchangeCodeServiceImpl     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a6117af] Transaction not enabled
15:48:11.527-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==>  Preparing: INSERT INTO exchange_code ( id, code, exchange_target_id, expired_time ) VALUES ( ?, ?, ?, ? )
15:48:11.527-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11601(Integer), NWHSFBLLAG(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.528-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11602(Integer), 9JHSFBLYMG(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.528-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11603(Integer), FLM832MMPG(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.528-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11604(Integer), 9BGFTHP3K2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.529-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11605(Integer), QYM832MDV2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.529-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11606(Integer), KA2WGCRCL2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.530-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11607(Integer), 6UCWAZ44KY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.530-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11608(Integer), BCGFTHPUVY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.531-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11609(Integer), EJM832M9LY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.531-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11610(Integer), HEM832MKXE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.531-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11611(Integer), AN2WGCRBUE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.532-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11612(Integer), Y9JCLKJWLE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.532-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11613(Integer), QC2WGCRGX4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.532-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11614(Integer), KPHSFBLRU4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.533-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11615(Integer), S32WGCRZ6J(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.533-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11616(Integer), WF2WGCRZZG(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.533-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11617(Integer), SSGFTHPHQG(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.534-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11618(Integer), WJHSFBLL62(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.534-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11619(Integer), PWHSFBLYZ2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.534-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11620(Integer), 4PM832MMQ2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.535-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11621(Integer), PSGFTHP3CY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.535-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11622(Integer), H2M832MDFY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.535-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11623(Integer), 2K2WGCRCGY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.535-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11624(Integer), LVCWAZ44CE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.536-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11625(Integer), T6GFTHPUFE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.536-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11626(Integer), KWM832M9GE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.536-[DESKTOP-FSAK1AQ][2aa35218dfa64e51a2d15a56688c6553]--DEBUG 33440 --- [nio-8091-exec-5] c.t.p.m.CouponMapper.selectPage_mpCount  : ==>  Preparing: SELECT COUNT(*) FROM coupon
15:48:11.536-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11627(Integer), V4M832MKS4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.536-[DESKTOP-FSAK1AQ][2aa35218dfa64e51a2d15a56688c6553]--DEBUG 33440 --- [nio-8091-exec-5] c.t.p.m.CouponMapper.selectPage_mpCount  : ==> Parameters: 
15:48:11.536-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11628(Integer), L92WGCRB34(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.537-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11629(Integer), ANJCLKJWG4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.537-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11630(Integer), H62WGCRGSJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.537-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11631(Integer), 2LHSFBLR3J(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.537-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11632(Integer), DLHSFBLR2G(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.537-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11633(Integer), FF2WGCRZB2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.537-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11634(Integer), RSGFTHPHN2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.538-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11635(Integer), FJHSFBLL22(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.538-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11636(Integer), KWHSFBLYBY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.538-[DESKTOP-FSAK1AQ][2aa35218dfa64e51a2d15a56688c6553]--DEBUG 33440 --- [nio-8091-exec-5] c.t.p.m.CouponMapper.selectPage_mpCount  : <==      Total: 1
15:48:11.538-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11637(Integer), XPM832MMNY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.538-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11638(Integer), 3SGFTHP3YY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.538-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11639(Integer), V2M832MD7E(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][2aa35218dfa64e51a2d15a56688c6553]--DEBUG 33440 --- [nio-8091-exec-5] c.t.p.mapper.CouponMapper.selectPage     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon ORDER BY create_time DESC LIMIT ?
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11640(Integer), DK2WGCRC9E(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][2aa35218dfa64e51a2d15a56688c6553]--DEBUG 33440 --- [nio-8091-exec-5] c.t.p.mapper.CouponMapper.selectPage     : ==> Parameters: 10(Long)
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11641(Integer), NVCWAZ44YE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11642(Integer), C6GFTHPU74(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11643(Integer), 2WM832M994(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11644(Integer), B4M832MKE4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11645(Integer), N92WGCRBHJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.539-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11646(Integer), 4NJCLKJW9J(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11647(Integer), V62WGCRGEJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11648(Integer), ZD2WGCRGH2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11649(Integer), Q2HSFBLR52(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11650(Integer), LZ2WGCRZ42(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11651(Integer), 6HGFTHPH8Y(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11652(Integer), 44HSFBLL5Y(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.540-[DESKTOP-FSAK1AQ][2aa35218dfa64e51a2d15a56688c6553]--DEBUG 33440 --- [nio-8091-exec-5] c.t.p.mapper.CouponMapper.selectPage     : <==      Total: 10
15:48:11.540-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11653(Integer), 2EHSFBLY4Y(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.541-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11654(Integer), YYM832MM8E(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.541-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11655(Integer), JHGFTHP3RE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.541-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11656(Integer), ZLM832MDJE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.541-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11657(Integer), QN2WGCRCD4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.541-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11658(Integer), WMCWAZ44R4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11659(Integer), 5DGFTHPUJ4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11660(Integer), 9EM832M9DJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11661(Integer), TJM832MKTJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11662(Integer), WA2WGCRBWJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11663(Integer), XKJCLKJWDW(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11664(Integer), UKJCLKJWT2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.542-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11665(Integer), ED2WGCRGW2(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.543-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11666(Integer), H2HSFBLRAY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.543-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11667(Integer), NZ2WGCRZMY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.543-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11668(Integer), GHGFTHPHPY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.543-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11669(Integer), X4HSFBLLAE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.543-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11670(Integer), ZEHSFBLYME(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11671(Integer), AYM832MMPE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11672(Integer), BHGFTHP3K4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11673(Integer), ELM832MDV4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11674(Integer), HN2WGCRCL4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11675(Integer), FMCWAZ44KJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11676(Integer), DDGFTHPUVJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11677(Integer), PEM832M9LJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.544-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11678(Integer), CJM832MKXW(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11679(Integer), FA2WGCRBUW(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11680(Integer), MK2WGCRB6Y(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11681(Integer), 7AJCLKJWXY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11682(Integer), K82WGCRGUY(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11683(Integer), VYHSFBLR6E(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11684(Integer), YX2WGCRZZE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11685(Integer), 87GFTHPHQE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11686(Integer), YEHSFBLL64(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11687(Integer), E4HSFBLYZ4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.545-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11688(Integer), G2M832MMQ4(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11689(Integer), T7GFTHP3CJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11690(Integer), KPM832MDFJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11691(Integer), V92WGCRCGJ(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11692(Integer), 4TCWAZ44CW(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11693(Integer), Q8GFTHPUFW(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11694(Integer), 34M832M9GW(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11695(Integer), 5WM832MKSP(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.546-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11696(Integer), 9WM832MK3Y(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.547-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11697(Integer), SK2WGCRB2Y(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.547-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11698(Integer), GAJCLKJWSE(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:11.547-[DESKTOP-FSAK1AQ][sys]--DEBUG 33440 --- [-code-handler-1] c.t.p.mapper.ExchangeCodeMapper.insert   : ==> Parameters: 11699(Integer), 282WGCRG3E(String), 1907339178157277186(Long), 2025-04-30T23:59:59(LocalDateTime)
15:48:12.911-[DESKTOP-FSAK1AQ][895c35e3b93d45a9bef92ab7459fd10a]--DEBUG 33440 --- [nio-8091-exec-6] c.t.p.m.E.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM exchange_code WHERE (exchange_target_id = ? AND status = ?)
15:48:12.912-[DESKTOP-FSAK1AQ][895c35e3b93d45a9bef92ab7459fd10a]--DEBUG 33440 --- [nio-8091-exec-6] c.t.p.m.E.selectPage_mpCount             : ==> Parameters: 1907339178157277186(Long), 1(Integer)
15:48:12.931-[DESKTOP-FSAK1AQ][895c35e3b93d45a9bef92ab7459fd10a]--DEBUG 33440 --- [nio-8091-exec-6] c.t.p.m.E.selectPage_mpCount             : <==      Total: 1
15:48:12.932-[DESKTOP-FSAK1AQ][895c35e3b93d45a9bef92ab7459fd10a]--DEBUG 33440 --- [nio-8091-exec-6] c.t.p.m.ExchangeCodeMapper.selectPage    : ==>  Preparing: SELECT id,code,status,user_id,type,exchange_target_id,create_time,expired_time,update_time FROM exchange_code WHERE (exchange_target_id = ? AND status = ?) LIMIT ?
15:48:12.932-[DESKTOP-FSAK1AQ][895c35e3b93d45a9bef92ab7459fd10a]--DEBUG 33440 --- [nio-8091-exec-6] c.t.p.m.ExchangeCodeMapper.selectPage    : ==> Parameters: 1907339178157277186(Long), 1(Integer), 20(Long)
15:48:12.935-[DESKTOP-FSAK1AQ][895c35e3b93d45a9bef92ab7459fd10a]--DEBUG 33440 --- [nio-8091-exec-6] c.t.p.m.ExchangeCodeMapper.selectPage    : <==      Total: 20
15:48:53.480-[DESKTOP-FSAK1AQ][4dcc0f484d0d45889f328c4f5e6b7e87]--DEBUG 33440 --- [nio-8091-exec-7] c.t.p.mapper.CouponMapper.selectList     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE (status = ? AND obtain_way = ?)
15:48:53.480-[DESKTOP-FSAK1AQ][4dcc0f484d0d45889f328c4f5e6b7e87]--DEBUG 33440 --- [nio-8091-exec-7] c.t.p.mapper.CouponMapper.selectList     : ==> Parameters: 3(Integer), 1(Integer)
15:48:53.482-[DESKTOP-FSAK1AQ][4dcc0f484d0d45889f328c4f5e6b7e87]--DEBUG 33440 --- [nio-8091-exec-7] c.t.p.mapper.CouponMapper.selectList     : <==      Total: 4
15:48:53.486-[DESKTOP-FSAK1AQ][4dcc0f484d0d45889f328c4f5e6b7e87]--DEBUG 33440 --- [nio-8091-exec-7] c.t.p.m.UserCouponMapper.selectList      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND coupon_id IN (?,?,?,?))
15:48:53.487-[DESKTOP-FSAK1AQ][4dcc0f484d0d45889f328c4f5e6b7e87]--DEBUG 33440 --- [nio-8091-exec-7] c.t.p.m.UserCouponMapper.selectList      : ==> Parameters: 2(Long), 1570595584270774274(Long), 1630121002899881985(Long), 1906331074426941442(Long), 1906935008178790402(Long)
15:48:53.488-[DESKTOP-FSAK1AQ][4dcc0f484d0d45889f328c4f5e6b7e87]--DEBUG 33440 --- [nio-8091-exec-7] c.t.p.m.UserCouponMapper.selectList      : <==      Total: 1
15:49:01.894-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
15:49:01.895-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
15:49:01.895-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
15:49:01.896-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
15:49:01.896-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
15:49:01.896-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
15:49:01.898-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
15:49:01.898-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
15:49:01.899-[DESKTOP-FSAK1AQ][e5d376b0394048c491486de64f885110]--DEBUG 33440 --- [nio-8091-exec-8] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
15:49:07.003-[DESKTOP-FSAK1AQ][d7c30e6f8e9f4d13a1d70d3d43479a64]--ERROR 33440 --- [io-8091-exec-10] c.t.c.a.m.advice.CommonExceptionAdvice   : 其他异常 uri : /user-coupons/282WGCRG3E/exchange -> 
org.springframework.expression.spel.SpelEvaluationException: EL1006E: Function 'T' could not be found
	at org.springframework.expression.spel.ast.FunctionReference.getValueInternal(FunctionReference.java:71) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueRef(CompoundExpression.java:55) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:91) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:112) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:273) ~[spring-expression-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.getLockName(LockAspect.java:96) ~[classes/:na]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:43) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
15:52:00.217-[DESKTOP-FSAK1AQ][310f5111705f4cbb83721f9f667d46e1]--ERROR 33440 --- [nio-8091-exec-1] c.t.c.a.m.advice.CommonExceptionAdvice   : 其他异常 uri : /user-coupons/282WGCRG3E/exchange -> 
org.springframework.expression.spel.SpelEvaluationException: EL1006E: Function 'T' could not be found
	at org.springframework.expression.spel.ast.FunctionReference.getValueInternal(FunctionReference.java:71) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueRef(CompoundExpression.java:55) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:91) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:112) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:273) ~[spring-expression-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.getLockName(LockAspect.java:96) ~[classes/:na]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:43) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
15:52:05.790-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
15:52:05.791-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
15:52:05.792-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
15:52:05.792-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
15:52:05.792-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
15:52:05.793-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
15:52:05.795-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
15:52:05.795-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
15:52:05.795-[DESKTOP-FSAK1AQ][066fdbb6798e428995a978f423e630db]--DEBUG 33440 --- [nio-8091-exec-2] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
15:52:19.906-[DESKTOP-FSAK1AQ][76fac02aaf5b45df9abca0c7944d3c47]--ERROR 33440 --- [nio-8091-exec-3] c.t.c.a.m.advice.CommonExceptionAdvice   : 其他异常 uri : /user-coupons/282WGCRG3E/exchange -> 
org.springframework.expression.spel.SpelEvaluationException: EL1006E: Function 'T' could not be found
	at org.springframework.expression.spel.ast.FunctionReference.getValueInternal(FunctionReference.java:71) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueRef(CompoundExpression.java:55) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:91) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:112) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:273) ~[spring-expression-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.getLockName(LockAspect.java:96) ~[classes/:na]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:43) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
15:52:57.231-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
15:52:57.231-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
15:52:57.231-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
15:52:57.232-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
15:52:57.232-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
15:52:57.233-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
15:52:57.234-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
15:52:57.234-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
15:52:57.234-[DESKTOP-FSAK1AQ][13780785f3e74a1db8b2101cbba95de0]--DEBUG 33440 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
15:53:01.050-[DESKTOP-FSAK1AQ][a77b6f7fb97a47319060a04a8ffabab9]--ERROR 33440 --- [nio-8091-exec-5] c.t.c.a.m.advice.CommonExceptionAdvice   : 其他异常 uri : /user-coupons/282WGCRG3E/exchange -> 
org.springframework.expression.spel.SpelEvaluationException: EL1006E: Function 'T' could not be found
	at org.springframework.expression.spel.ast.FunctionReference.getValueInternal(FunctionReference.java:71) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueRef(CompoundExpression.java:55) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:91) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.ast.SpelNodeImpl.getValue(SpelNodeImpl.java:112) ~[spring-expression-5.3.22.jar:5.3.22]
	at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:273) ~[spring-expression-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.getLockName(LockAspect.java:96) ~[classes/:na]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:43) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
15:54:23.818-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
15:54:23.818-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
15:54:23.818-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
15:54:23.819-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
15:54:23.825-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Waiting for workers to finish.
15:54:23.909-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Successfully waited for workers to finish.
15:54:24.050-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server stop.
15:54:24.053-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job registry-remove success, registryParam:RegistryParam{registryGroup='EXECUTOR', registryKey='promotion-service', registryValue='http://192.168.150.1:9999/'}, registryResult:ReturnT [code=200, msg=null, content=null]
15:54:24.054-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job, executor registry thread destroy.
15:54:24.054-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server destroy success.
15:54:24.054-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [FileCleanThread] c.x.j.core.thread.JobLogFileCleanThread  : >>>>>>>>>>> xxl-job, executor JobLogFileCleanThread thread destroy.
15:54:24.054-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [rCallbackThread] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor callback thread destroy.
15:54:24.054-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [      Thread-11] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor retry callback thread destroy.
15:54:24.055-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
15:54:24.055-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [BEAT] removing beat: DEFAULT_GROUP@@promotion-service:192.168.150.1:8091 from beat map.
15:54:24.055-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [DEREGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 deregistering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
15:54:24.056-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
15:54:24.057-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown begin
15:54:24.595-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[],\"lastRefTime\":1743580464611,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":12893554041871} from /192.168.150.101
15:54:24.595-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [g.push.receiver] com.alibaba.nacos.client.naming          : removed ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
15:54:24.602-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(0) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> []
15:54:25.550-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown stop
15:54:25.550-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown begin
15:54:28.568-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown begin
15:54:31.585-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown stop
15:54:31.585-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
15:54:31.585-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
15:54:31.585-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown stop
15:54:31.585-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown begin
15:54:31.585-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Start destroying NacosRestTemplate
15:54:31.586-[DESKTOP-FSAK1AQ][sys]-- WARN 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Destruction of the end
15:54:31.586-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] c.a.n.client.identify.CredentialWatcher  : [null] CredentialWatcher is stopped
15:54:31.586-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] c.a.n.client.identify.CredentialService  : [null] CredentialService is freed
15:54:31.586-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown stop
15:54:31.605-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] o.s.a.r.l.SimpleMessageListenerContainer : Shutdown ignored - container is already stopped
15:54:31.728-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
15:54:31.736-[DESKTOP-FSAK1AQ][sys]-- INFO 33440 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
15:54:37.930-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.tianji.promotion.PromotionApplication  : The following 1 profile is active: "local"
15:54:38.321-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:54:38.322-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:54:38.333-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
15:54:38.459-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=2a5e96f4-55e3-3f97-bb3d-bfd0bc68bfd7
15:54:38.590-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:54:38.591-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:54:38.592-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$663/0x0000000800601040] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:54:38.594-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:54:38.608-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.cloud.sentinel-com.alibaba.cloud.sentinel.SentinelProperties' of type [com.alibaba.cloud.sentinel.SentinelProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:54:38.609-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration' of type [com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:54:38.716-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8091 (http)
15:54:38.721-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:54:38.721-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
15:54:38.784-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:54:38.784-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 845 ms
15:54:39.850-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:54:40.041-[DESKTOP-FSAK1AQ][sys]--DEBUG 18444 --- [           main] c.t.c.a.redisson.RedissonConfig          : 尝试初始化RedissonClient
15:54:40.062-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] org.redisson.Version                     : Redisson 3.13.6
15:54:40.271-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [sson-netty-4-19] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for /192.168.150.101:6379
15:54:40.284-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [sson-netty-4-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for /192.168.150.101:6379
15:54:40.399-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.c.sentinel.SentinelWebMvcConfigurer  : [Sentinel Starter] register SentinelWebInterceptor with urlPatterns: [/**].
15:54:40.596-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'auth-service' URL not provided. Will try picking an instance via load-balancing.
15:54:40.619-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config init.
15:54:40.619-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config end.
15:54:41.903-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
15:54:41.984-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:sendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@eb65fc8[class com.tianji.promotion.handler.SendCouponHandler#sendCouponByTime]
15:54:41.984-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:stopSendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@5cd5e1b6[class com.tianji.promotion.handler.SendCouponHandler#stopSendCouponByTime]
15:54:42.000-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.008-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.016-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.022-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'exam-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.031-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'learning-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.037-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'remark-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.043-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'search-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.048-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'trade-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.054-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'user-service' URL not provided. Will try picking an instance via load-balancing.
15:54:42.100-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 9999
15:54:42.146-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
15:54:42.147-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Environment :null
15:54:42.147-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
15:54:42.171-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8091 (http) with context path ''
15:54:42.173-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
15:54:42.174-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] com.alibaba.nacos.client.naming          : [REGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 registering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={preserved.register.source=SPRING_CLOUD}}
15:54:42.176-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP promotion-service 192.168.150.1:8091 register finished
15:54:42.756-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580482771,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":12911714203841} from /192.168.150.101
15:54:42.760-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [g.push.receiver] com.alibaba.nacos.client.naming          : new ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
15:54:42.768-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
15:54:43.352-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
15:54:43.486-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.150.101:5672]
15:54:43.502-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Created new connection: rabbitConnectionFactory#c555e1e:0/SimpleConnection@3b8b1ba9 [delegate=amqp://tjxt@192.168.150.101:5672//tjxt, localPort= 61439]
15:54:43.534-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.tianji.promotion.PromotionApplication  : Started PromotionApplication in 8.542 seconds (JVM running for 8.961)
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service-local.yaml+DEFAULT_GROUP
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service-local.yaml, group=DEFAULT_GROUP, cnt=1
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service-local.yaml, group=DEFAULT_GROUP
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service+DEFAULT_GROUP
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service, group=DEFAULT_GROUP, cnt=1
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service, group=DEFAULT_GROUP
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service.yaml+DEFAULT_GROUP
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service.yaml, group=DEFAULT_GROUP, cnt=1
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service.yaml, group=DEFAULT_GROUP
15:54:43.537-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [           main] c.tianji.promotion.PromotionApplication  : --/
---------------------------------------------------------------------------------------
	Application 'promotion-service' is running! Access URLs:
	Local: 		http://localhost:8091
	External: 	http://192.168.150.1:8091
	Profile(s): 	[local]
---------------------------------------------------------------------------------------
15:55:06.161-[DESKTOP-FSAK1AQ][sys]-- WARN 18444 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
15:55:06.161-[DESKTOP-FSAK1AQ][sys]-- WARN 18444 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
15:55:06.161-[DESKTOP-FSAK1AQ][sys]-- WARN 18444 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
15:55:06.162-[DESKTOP-FSAK1AQ][sys]-- WARN 18444 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
15:55:06.166-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Waiting for workers to finish.
15:55:06.674-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Successfully waited for workers to finish.
15:55:06.803-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server stop.
15:55:06.806-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job registry-remove success, registryParam:RegistryParam{registryGroup='EXECUTOR', registryKey='promotion-service', registryValue='http://192.168.150.1:9999/'}, registryResult:ReturnT [code=200, msg=null, content=null]
15:55:06.806-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job, executor registry thread destroy.
15:55:06.806-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server destroy success.
15:55:06.806-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [FileCleanThread] c.x.j.core.thread.JobLogFileCleanThread  : >>>>>>>>>>> xxl-job, executor JobLogFileCleanThread thread destroy.
15:55:06.807-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [rCallbackThread] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor callback thread destroy.
15:55:06.807-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [      Thread-11] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor retry callback thread destroy.
15:55:06.807-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
15:55:06.807-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [BEAT] removing beat: DEFAULT_GROUP@@promotion-service:192.168.150.1:8091 from beat map.
15:55:06.807-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [DEREGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 deregistering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
15:55:06.809-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
15:55:06.809-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown begin
15:55:07.210-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown stop
15:55:07.210-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown begin
15:55:07.339-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[],\"lastRefTime\":1743580507355,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":12936297804830} from /192.168.150.101
15:55:07.339-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [g.push.receiver] com.alibaba.nacos.client.naming          : removed ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
15:55:07.346-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(0) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> []
15:55:10.239-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown begin
15:55:13.252-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown stop
15:55:13.252-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown stop
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown begin
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- WARN 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Start destroying NacosRestTemplate
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- WARN 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Destruction of the end
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] c.a.n.client.identify.CredentialWatcher  : [null] CredentialWatcher is stopped
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] c.a.n.client.identify.CredentialService  : [null] CredentialService is freed
15:55:13.253-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown stop
15:55:13.272-[DESKTOP-FSAK1AQ][sys]-- INFO 18444 --- [ionShutdownHook] o.s.a.r.l.SimpleMessageListenerContainer : Shutdown ignored - container is already stopped
15:55:19.193-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.tianji.promotion.PromotionApplication  : The following 1 profile is active: "local"
15:55:19.594-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
15:55:19.595-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
15:55:19.606-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
15:55:19.733-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=2a5e96f4-55e3-3f97-bb3d-bfd0bc68bfd7
15:55:19.889-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:55:19.891-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:55:19.891-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$663/0x0000000800601040] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:55:19.893-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:55:19.908-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.cloud.sentinel-com.alibaba.cloud.sentinel.SentinelProperties' of type [com.alibaba.cloud.sentinel.SentinelProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:55:19.910-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration' of type [com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
15:55:20.038-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8091 (http)
15:55:20.044-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
15:55:20.044-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
15:55:20.162-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
15:55:20.162-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 960 ms
15:55:21.282-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:55:21.494-[DESKTOP-FSAK1AQ][sys]--DEBUG 6640 --- [           main] c.t.c.a.redisson.RedissonConfig          : 尝试初始化RedissonClient
15:55:21.516-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] org.redisson.Version                     : Redisson 3.13.6
15:55:21.725-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [sson-netty-4-18] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for /192.168.150.101:6379
15:55:21.736-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [sson-netty-4-19] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for /192.168.150.101:6379
15:55:21.853-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.c.sentinel.SentinelWebMvcConfigurer  : [Sentinel Starter] register SentinelWebInterceptor with urlPatterns: [/**].
15:55:22.048-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'auth-service' URL not provided. Will try picking an instance via load-balancing.
15:55:22.072-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config init.
15:55:22.072-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config end.
15:55:23.358-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
15:55:23.439-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:sendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@a49cdd6[class com.tianji.promotion.handler.SendCouponHandler#sendCouponByTime]
15:55:23.439-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:stopSendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@109a462e[class com.tianji.promotion.handler.SendCouponHandler#stopSendCouponByTime]
15:55:23.455-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.463-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.471-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.477-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'exam-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.486-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'learning-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.493-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'remark-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.499-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'search-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.504-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'trade-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.511-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'user-service' URL not provided. Will try picking an instance via load-balancing.
15:55:23.555-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 9999
15:55:23.602-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
15:55:23.603-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Environment :null
15:55:23.603-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
15:55:23.630-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8091 (http) with context path ''
15:55:23.632-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
15:55:23.632-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] com.alibaba.nacos.client.naming          : [REGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 registering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={preserved.register.source=SPRING_CLOUD}}
15:55:23.634-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP promotion-service 192.168.150.1:8091 register finished
15:55:24.193-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580524209,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":12953151724527} from /192.168.150.101
15:55:24.197-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : new ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
15:55:24.205-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
15:55:24.822-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
15:55:25.002-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.150.101:5672]
15:55:25.019-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Created new connection: rabbitConnectionFactory#c555e1e:0/SimpleConnection@7985c32f [delegate=amqp://tjxt@192.168.150.101:5672//tjxt, localPort= 61704]
15:55:25.051-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.tianji.promotion.PromotionApplication  : Started PromotionApplication in 8.753 seconds (JVM running for 9.174)
15:55:25.054-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service-local.yaml+DEFAULT_GROUP
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service-local.yaml, group=DEFAULT_GROUP, cnt=1
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service-local.yaml, group=DEFAULT_GROUP
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service+DEFAULT_GROUP
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service, group=DEFAULT_GROUP, cnt=1
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service, group=DEFAULT_GROUP
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service.yaml+DEFAULT_GROUP
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service.yaml, group=DEFAULT_GROUP, cnt=1
15:55:25.055-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service.yaml, group=DEFAULT_GROUP
15:55:25.056-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [           main] c.tianji.promotion.PromotionApplication  : --/
---------------------------------------------------------------------------------------
	Application 'promotion-service' is running! Access URLs:
	Local: 		http://localhost:8091
	External: 	http://192.168.150.1:8091
	Profile(s): 	[local]
---------------------------------------------------------------------------------------
15:55:26.082-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [nio-8091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
15:55:26.082-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [nio-8091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
15:55:26.083-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [nio-8091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
15:55:26.211-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]-- INFO 6640 --- [nio-8091-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
15:55:26.334-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]-- INFO 6640 --- [nio-8091-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
15:55:26.339-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
15:55:26.351-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
15:55:26.364-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
15:55:26.369-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
15:55:26.370-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
15:55:26.374-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
15:55:26.379-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
15:55:26.379-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
15:55:26.382-[DESKTOP-FSAK1AQ][94dd783cd37d4e50ac5b4a7664518c0e]--DEBUG 6640 --- [nio-8091-exec-2] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
15:55:29.821-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [nio-8091-exec-3] c.t.c.autoconfigure.mq.RabbitMqHelper    : 准备发送消息，exchange：promotion.topic， RoutingKey：coupon_receive， message：UserCouponDTO(userId=2, couponId=1907339178157277186, serialNum=11699)
15:55:29.845-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
15:55:29.845-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
15:55:29.845-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
15:55:29.846-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
15:55:29.847-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
15:55:29.848-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
15:55:29.848-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
15:55:29.848-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
15:55:29.849-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
15:55:29.849-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
15:55:29.849-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
15:55:29.849-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
15:55:29.849-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
15:55:29.850-[DESKTOP-FSAK1AQ][6a2beaf5c60547a38be1f84d1da711c0]--DEBUG 6640 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
15:55:29.850-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
15:55:29.853-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
15:55:29.854-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907341101136658433(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T15:55:29.850777800(LocalDateTime), 2025-04-12T15:55:29.850777800(LocalDateTime)
15:55:29.856-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
15:55:29.860-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
15:55:29.861-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11699(Integer)
15:55:30.909-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
15:55:30.915-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
15:55:30.916-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
15:55:30.917-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
15:55:30.918-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
15:55:30.918-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
15:55:30.919-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
15:55:30.919-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
15:55:30.920-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907341105557454849(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T15:55:30.919184400(LocalDateTime), 2025-04-12T15:55:30.919184400(LocalDateTime)
15:55:30.920-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
15:55:30.921-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
15:55:30.921-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11699(Integer)
15:55:32.938-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
15:55:32.942-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
15:55:32.942-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
15:55:32.943-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
15:55:32.943-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
15:55:32.944-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
15:55:32.945-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
15:55:32.945-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
15:55:32.946-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907341114080280578(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T15:55:32.945433700(LocalDateTime), 2025-04-12T15:55:32.945433700(LocalDateTime)
15:55:32.946-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
15:55:32.947-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
15:55:32.947-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11699(Integer)
15:55:32.950-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
15:55:32.952-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]-- WARN 6640 --- [ntContainer#0-1] o.s.a.r.retry.RepublishMessageRecoverer  : Republishing failed message to exchange 'error.topic' with routing key error.promotion-service
15:55:32.952-[DESKTOP-FSAK1AQ][a12be0b5c92242f1a1496534266a1306]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.ImmediateAcknowledgeAmqpException: Recovered message forces ack (if ack mode requires it): (Body:'[B@6d85fe2a(byte[65])' MessageProperties [headers={x-exception-message=
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null, requestId=a12be0b5c92242f1a1496534266a1306, x-original-routingKey=coupon_receive, x-original-exchange=promotion.topic, __TypeId__=com.tianji.promotion.domain.dto.UserCouponDTO, x-exception-stacktrace=org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209)
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329)
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255)
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy120.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy127.update(Unknown Source)
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45)
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35)
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139)
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>)
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262)
	... 27 more
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy234.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy232.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62)
	at com.sun.proxy.$Proxy230.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 60 more
}, messageId=2d6a5c8c-f3d7-44b0-b523-5defdffb77c5, contentType=application/json, contentEncoding=UTF-8, contentLength=0, deliveryMode=PERSISTENT, receivedDeliveryMode=PERSISTENT, priority=0, redelivered=true, receivedExchange=promotion.topic, receivedRoutingKey=coupon_receive, deliveryTag=4, consumerTag=amq.ctag-hoWJ2HZl2eKH7ht_yMZWvQ, consumerQueue=coupon.receive.queue])
	at org.springframework.amqp.rabbit.config.StatefulRetryOperationsInterceptorFactoryBean.lambda$createRecoverer$1(StatefulRetryOperationsInterceptorFactoryBean.java:115) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$ItemRecovererCallback.recover(StatefulRetryOperationsInterceptor.java:244) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.handleRetryExhausted(RetryTemplate.java:539) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:387) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	... 14 common frames omitted
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
15:55:34.783-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
15:55:34.784-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
15:55:34.785-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
15:55:34.786-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
15:55:34.786-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
15:55:34.787-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
15:55:34.787-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
15:55:34.787-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
15:55:34.789-[DESKTOP-FSAK1AQ][638af39301f347f18d96e2391cad47aa]--DEBUG 6640 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
16:00:07.859-[DESKTOP-FSAK1AQ][8bb356a65f7e4ab291a0eb535954002a]--ERROR 6640 --- [nio-8091-exec-7] c.t.c.a.m.advice.CommonExceptionAdvice   : 自定义异常 -> com.tianji.common.exceptions.BizIllegalException , 状态码：500, 异常原因：兑换码已经被兑换过了  
16:00:07.860-[DESKTOP-FSAK1AQ][8bb356a65f7e4ab291a0eb535954002a]--DEBUG 6640 --- [nio-8091-exec-7] c.t.c.a.m.advice.CommonExceptionAdvice   : 
com.tianji.common.exceptions.BizIllegalException: 兑换码已经被兑换过了
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.exchangeCodeUserCoupon(UserCouponServiceImpl.java:173) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
16:00:57.403-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580856094,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13285036652132} from /192.168.150.101
16:02:36.364-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [l-1 housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m38s961ms473µs900ns).
16:00:57.405-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:02:36.366-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.375-[DESKTOP-FSAK1AQ][b04270989d844dc392d203d4ed3ed857]--ERROR 6640 --- [nio-8091-exec-5] c.t.c.a.m.advice.CommonExceptionAdvice   : 其他异常 uri : /user-coupons/GAJCLKJWSE/exchange -> 
java.lang.IllegalMonitorStateException: attempt to unlock lock, not locked by current thread by node id: 83b4ec7e-a333-4f2d-84a5-548a35460f51 thread-id: 118
	at org.redisson.RedissonLock.lambda$unlockAsync$3(RedissonLock.java:605) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.misc.RedissonPromise.lambda$onComplete$0(RedissonPromise.java:187) ~[redisson-3.13.6.jar:3.13.6]
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:578) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:552) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:491) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:616) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.DefaultPromise.setSuccess0(DefaultPromise.java:605) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:104) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at org.redisson.misc.RedissonPromise.trySuccess(RedissonPromise.java:82) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.completeResponse(CommandDecoder.java:451) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.handleResult(CommandDecoder.java:445) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:376) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.decodeCommandBatch(CommandDecoder.java:265) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.decodeCommand(CommandDecoder.java:207) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:134) ~[redisson-3.13.6.jar:3.13.6]
	at org.redisson.client.handler.CommandDecoder.decode(CommandDecoder.java:104) ~[redisson-3.13.6.jar:3.13.6]
	at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:510) ~[netty-codec-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.handler.codec.ReplayingDecoder.callDecode(ReplayingDecoder.java:366) ~[netty-codec-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:279) ~[netty-codec-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) ~[netty-transport-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[netty-common-4.1.79.Final.jar:4.1.79.Final]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
16:02:36.376-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.377-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580858000,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13286942700645} from /192.168.150.101
16:02:36.377-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:02:36.377-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.381-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.381-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580856094,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13285036652132} from /192.168.150.101
16:02:36.381-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : out of date data received, old-t: 1743580858000, new-t: 1743580856094
16:02:36.381-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:02:36.381-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.384-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.385-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580858000,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13286942700645} from /192.168.150.101
16:02:36.385-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:02:36.385-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.386-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.386-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580876160,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13305102728191} from /192.168.150.101
16:02:36.386-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:02:36.386-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.387-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.387-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580876160,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13305102728191} from /192.168.150.101
16:02:36.387-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[],\"lastRefTime\":1743580891107,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13320050018365} from /192.168.150.101
16:02:36.387-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : removed ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:36.390-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(0) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> []
16:02:36.390-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[],\"lastRefTime\":1743580891107,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13320050018365} from /192.168.150.101
16:02:41.389-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ing.beat.sender] com.alibaba.nacos.client.naming          : [REGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 registering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='DEFAULT_GROUP@@promotion-service', metadata={preserved.register.source=SPRING_CLOUD}}
16:02:46.973-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743580966990,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13395932871632} from /192.168.150.101
16:02:46.973-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : new ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:02:46.980-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:03:28.492-[DESKTOP-FSAK1AQ][d6a287e563684007b72e960cf0400294]--ERROR 6640 --- [nio-8091-exec-9] c.t.c.a.m.advice.CommonExceptionAdvice   : 自定义异常 -> com.tianji.common.exceptions.BizIllegalException , 状态码：500, 异常原因：兑换码已经被兑换过了  
16:03:28.492-[DESKTOP-FSAK1AQ][d6a287e563684007b72e960cf0400294]--DEBUG 6640 --- [nio-8091-exec-9] c.t.c.a.m.advice.CommonExceptionAdvice   : 
com.tianji.common.exceptions.BizIllegalException: 兑换码已经被兑换过了
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.exchangeCodeUserCoupon(UserCouponServiceImpl.java:173) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
16:05:18.444-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [nio-8091-exec-2] c.t.c.autoconfigure.mq.RabbitMqHelper    : 准备发送消息，exchange：promotion.topic， RoutingKey：coupon_receive， message：UserCouponDTO(userId=2, couponId=1907339178157277186, serialNum=11697)
16:05:21.895-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:05:21.895-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:05:21.897-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:05:21.897-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:05:21.897-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:05:21.898-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:05:21.898-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:05:21.899-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907343584336592898(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:05:21.898936200(LocalDateTime), 2025-04-12T16:05:21.898936200(LocalDateTime)
16:05:21.899-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:05:21.900-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:05:21.900-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11697(Integer)
16:05:22.917-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
16:05:22.920-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:05:22.920-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:05:22.922-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:05:22.922-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:05:22.922-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:05:22.923-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:05:22.923-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:05:22.923-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907343588644143106(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:05:22.923228600(LocalDateTime), 2025-04-12T16:05:22.923228600(LocalDateTime)
16:05:22.924-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:05:22.924-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:05:22.925-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11697(Integer)
16:05:24.936-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
16:05:24.939-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:05:24.939-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:05:24.939-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:05:24.940-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:05:24.940-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:05:24.941-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:05:24.942-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:05:24.942-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907343597099859969(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:05:24.941890400(LocalDateTime), 2025-04-12T16:05:24.941890400(LocalDateTime)
16:05:24.943-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:05:24.944-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:05:24.944-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11697(Integer)
16:05:24.946-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor191.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor190.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
16:05:24.946-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]-- WARN 6640 --- [ntContainer#0-1] o.s.a.r.retry.RepublishMessageRecoverer  : Republishing failed message to exchange 'error.topic' with routing key error.promotion-service
16:05:24.947-[DESKTOP-FSAK1AQ][e39ba8f3590c46e6aa296fca1eb75909]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.ImmediateAcknowledgeAmqpException: Recovered message forces ack (if ack mode requires it): (Body:'[B@da2cc97(byte[65])' MessageProperties [headers={x-exception-message=
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null, requestId=e39ba8f3590c46e6aa296fca1eb75909, x-original-routingKey=coupon_receive, x-original-exchange=promotion.topic, __TypeId__=com.tianji.promotion.domain.dto.UserCouponDTO, x-exception-stacktrace=org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209)
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329)
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255)
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy120.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy127.update(Unknown Source)
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45)
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35)
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139)
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>)
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262)
	... 27 more
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy234.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at jdk.internal.reflect.GeneratedMethodAccessor191.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy232.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor190.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62)
	at com.sun.proxy.$Proxy230.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 60 more
}, messageId=389b84cc-ad39-4a1a-a502-3db07920bf0e, contentType=application/json, contentEncoding=UTF-8, contentLength=0, deliveryMode=PERSISTENT, receivedDeliveryMode=PERSISTENT, priority=0, redelivered=true, receivedExchange=promotion.topic, receivedRoutingKey=coupon_receive, deliveryTag=8, consumerTag=amq.ctag-hoWJ2HZl2eKH7ht_yMZWvQ, consumerQueue=coupon.receive.queue])
	at org.springframework.amqp.rabbit.config.StatefulRetryOperationsInterceptorFactoryBean.lambda$createRecoverer$1(StatefulRetryOperationsInterceptorFactoryBean.java:115) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$ItemRecovererCallback.recover(StatefulRetryOperationsInterceptor.java:244) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.handleRetryExhausted(RetryTemplate.java:539) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:387) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	... 14 common frames omitted
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor191.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor190.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
16:07:19.453-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [nio-8091-exec-1] c.t.c.autoconfigure.mq.RabbitMqHelper    : 准备发送消息，exchange：promotion.topic， RoutingKey：coupon_receive， message：UserCouponDTO(userId=2, couponId=1907339178157277186, serialNum=11696)
16:07:23.811-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:07:23.812-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:07:23.823-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:07:30.770-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:07:30.771-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:07:30.773-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:07:57.163-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:07:57.165-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907344235581980673(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:07:35.058858200(LocalDateTime), 2025-04-12T16:07:35.058858200(LocalDateTime)
16:07:57.166-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:08:12.092-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581292030,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13720972673256} from /192.168.150.101
16:08:14.009-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:08:46.858-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ing.beat.sender] com.alibaba.nacos.client.naming          : [REGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 registering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='DEFAULT_GROUP@@promotion-service', metadata={preserved.register.source=SPRING_CLOUD}}
16:08:46.860-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.867-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:08:46.868-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.868-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11696(Integer)
16:08:46.868-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581292631,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13721574059555} from /192.168.150.101
16:08:46.868-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : out of date data received, old-t: 1743581326876, new-t: 1743581292631
16:08:46.868-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:08:46.869-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.873-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.873-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581292030,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13720972673256} from /192.168.150.101
16:08:46.873-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : out of date data received, old-t: 1743581292631, new-t: 1743581292030
16:08:46.873-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:08:46.873-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.877-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.877-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581292631,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13721574059555} from /192.168.150.101
16:08:46.877-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:08:46.877-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.878-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.878-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581311991,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13740934384155} from /192.168.150.101
16:08:46.878-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:08:46.878-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.879-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.879-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581311991,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13740934384155} from /192.168.150.101
16:08:46.923-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581326941,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13755884453207} from /192.168.150.101
16:08:46.924-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:08:46.924-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:46.930-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:08:47.882-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor191.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor190.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
16:09:05.952-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":false,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581342396,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13771338961574} from /192.168.150.101
16:09:05.953-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:09:05.953-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:09:05.953-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:09:05.953-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:09:05.955-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:09:05.955-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:09:05.955-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:09:05.956-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:09:05.957-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:09:05.957-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907344524129124354(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:09:05.956960900(LocalDateTime), 2025-04-12T16:09:05.956960900(LocalDateTime)
16:09:05.958-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:09:05.959-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:09:05.959-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 6640 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), null, 11696(Integer)
16:09:05.960-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":false,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:09:05.968-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
16:09:05.968-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
16:09:05.968-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
16:09:05.969-[DESKTOP-FSAK1AQ][sys]-- WARN 6640 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
16:09:05.974-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Waiting for workers to finish.
16:09:06.492-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581346510,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13775452770270} from /192.168.150.101
16:09:06.492-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:09:06.492-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : modified ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:09:06.498-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:09:07.969-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]-- WARN 6640 --- [ntContainer#0-1] s.a.r.l.ConditionalRejectingErrorHandler : Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(com.tianji.promotion.domain.dto.UserCouponDTO)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:271) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:208) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:147) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1670) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1589) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor$StatefulMethodInvocationRetryCallback.doWithRetry(StatefulRetryOperationsInterceptor.java:209) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:255) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.retry.interceptor.StatefulRetryOperationsInterceptor.invoke(StatefulRetryOperationsInterceptor.java:166) ~[spring-retry-1.3.3.jar:na]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.$Proxy205.invokeListener(Unknown Source) ~[na:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1577) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1568) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1512) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:993) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:940) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:84) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1317) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1223) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
### The error may exist in com/tianji/promotion/mapper/ExchangeCodeMapper.java (best guess)
### The error may involve com.tianji.promotion.mapper.ExchangeCodeMapper.update-Inline
### The error occurred while setting parameters
### SQL: UPDATE exchange_code  SET status=?,user_id=?      WHERE (id = ?)
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
; Column 'user_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79) ~[spring-jdbc-5.3.22.jar:5.3.22]
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.sun.proxy.$Proxy120.update(Unknown Source) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288) ~[mybatis-spring-2.0.6.jar:2.0.6]
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89) ~[mybatis-plus-core-3.4.3.jar:3.4.3]
	at com.sun.proxy.$Proxy127.update(Unknown Source) ~[na:na]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:45) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.baomidou.mybatisplus.extension.conditions.update.ChainUpdate.update(ChainUpdate.java:35) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.checkAndCreateUserCoupon(UserCouponServiceImpl.java:139) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.checkAndCreateUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.handler.PromotionMqHandler.listenCouponReceiveMessage(PromotionMqHandler.java:28) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.22.jar:5.3.22]
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:75) ~[spring-rabbit-2.4.6.jar:2.4.6]
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:262) ~[spring-rabbit-2.4.6.jar:2.4.6]
	... 27 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'user_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370) ~[mysql-connector-java-8.0.23.jar:8.0.23]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java) ~[HikariCP-4.0.3.jar:na]
	at jdk.internal.reflect.GeneratedMethodAccessor163.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy234.execute(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor191.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy232.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117) ~[mybatis-3.5.7.jar:3.5.7]
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76) ~[mybatis-3.5.7.jar:3.5.7]
	at jdk.internal.reflect.GeneratedMethodAccessor190.invoke(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49) ~[mybatis-3.5.7.jar:3.5.7]
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:106) ~[mybatis-plus-extension-3.4.3.jar:3.4.3]
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62) ~[mybatis-3.5.7.jar:3.5.7]
	at com.sun.proxy.$Proxy230.update(Unknown Source) ~[na:na]
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194) ~[mybatis-3.5.7.jar:3.5.7]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427) ~[mybatis-spring-2.0.6.jar:2.0.6]
	... 60 common frames omitted
16:09:07.972-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Successfully waited for workers to finish.
16:09:08.113-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server stop.
16:09:08.116-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job registry-remove success, registryParam:RegistryParam{registryGroup='EXECUTOR', registryKey='promotion-service', registryValue='http://192.168.150.1:9999/'}, registryResult:ReturnT [code=200, msg=null, content=null]
16:09:08.116-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job, executor registry thread destroy.
16:09:08.116-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server destroy success.
16:09:08.117-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [FileCleanThread] c.x.j.core.thread.JobLogFileCleanThread  : >>>>>>>>>>> xxl-job, executor JobLogFileCleanThread thread destroy.
16:09:08.117-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [rCallbackThread] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor callback thread destroy.
16:09:08.117-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [      Thread-11] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor retry callback thread destroy.
16:09:08.118-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
16:09:08.118-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [BEAT] removing beat: DEFAULT_GROUP@@promotion-service:192.168.150.1:8091 from beat map.
16:09:08.118-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [DEREGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 deregistering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
16:09:08.120-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
16:09:08.120-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown begin
16:09:08.698-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[],\"lastRefTime\":1743581348717,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13777659735111} from /192.168.150.101
16:09:08.699-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : removed ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
16:09:08.705-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(0) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> []
16:09:11.138-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown stop
16:09:11.139-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown begin
16:09:14.156-[DESKTOP-FSAK1AQ][sys]-- INFO 6640 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown begin
16:09:26.578-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.tianji.promotion.PromotionApplication  : The following 1 profile is active: "local"
16:09:26.976-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
16:09:26.977-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
16:09:26.988-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
16:09:27.116-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=2a5e96f4-55e3-3f97-bb3d-bfd0bc68bfd7
16:09:27.251-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
16:09:27.253-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
16:09:27.253-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$663/0x0000000800601040] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
16:09:27.255-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
16:09:27.269-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.cloud.sentinel-com.alibaba.cloud.sentinel.SentinelProperties' of type [com.alibaba.cloud.sentinel.SentinelProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
16:09:27.271-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] trationDelegate$BeanPostProcessorChecker : Bean 'com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration' of type [com.alibaba.cloud.sentinel.custom.SentinelAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
16:09:27.380-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8091 (http)
16:09:27.385-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
16:09:27.385-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
16:09:27.451-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
16:09:27.451-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 864 ms
16:09:28.540-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
16:09:28.752-[DESKTOP-FSAK1AQ][sys]--DEBUG 10352 --- [           main] c.t.c.a.redisson.RedissonConfig          : 尝试初始化RedissonClient
16:09:28.773-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] org.redisson.Version                     : Redisson 3.13.6
16:09:28.985-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [sson-netty-4-23] o.r.c.pool.MasterPubSubConnectionPool    : 1 connections initialized for /192.168.150.101:6379
16:09:28.997-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [sson-netty-4-20] o.r.c.pool.MasterConnectionPool          : 24 connections initialized for /192.168.150.101:6379
16:09:29.119-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.c.sentinel.SentinelWebMvcConfigurer  : [Sentinel Starter] register SentinelWebInterceptor with urlPatterns: [/**].
16:09:29.333-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'auth-service' URL not provided. Will try picking an instance via load-balancing.
16:09:29.358-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config init.
16:09:29.358-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.t.c.autoconfigure.xxljob.XxlJobConfig  : >>>>>>>>>>> xxl-job config end.
16:09:30.657-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
16:09:30.741-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:sendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@a49cdd6[class com.tianji.promotion.handler.SendCouponHandler#sendCouponByTime]
16:09:30.742-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.xxl.job.core.executor.XxlJobExecutor   : >>>>>>>>>>> xxl-job register jobhandler success, name:stopSendCouponByTime, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@109a462e[class com.tianji.promotion.handler.SendCouponHandler#stopSendCouponByTime]
16:09:30.757-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.765-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.773-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'course-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.780-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'exam-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.789-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'learning-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.795-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'remark-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.801-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'search-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.807-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'trade-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.813-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.c.openfeign.FeignClientFactoryBean   : For 'user-service' URL not provided. Will try picking an instance via load-balancing.
16:09:30.857-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 9999
16:09:30.902-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
16:09:30.902-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Environment :null
16:09:30.902-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] com.alibaba.nacos.client.naming          : initializer namespace from System Property :null
16:09:30.925-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8091 (http) with context path ''
16:09:30.927-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] com.alibaba.nacos.client.naming          : [BEAT] adding beat: BeatInfo{port=8091, ip='192.168.150.1', weight=1.0, serviceName='DEFAULT_GROUP@@promotion-service', cluster='DEFAULT', metadata={preserved.register.source=SPRING_CLOUD}, scheduled=false, period=5000, stopped=false} to beat map.
16:09:30.928-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] com.alibaba.nacos.client.naming          : [REGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 registering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={preserved.register.source=SPRING_CLOUD}}
16:09:30.929-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.c.n.registry.NacosServiceRegistry    : nacos registry, DEFAULT_GROUP promotion-service 192.168.150.1:8091 register finished
16:09:31.480-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[{\"instanceId\":\"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service\",\"ip\":\"192.168.150.1\",\"port\":8091,\"weight\":1.0,\"healthy\":true,\"enabled\":true,\"ephemeral\":true,\"clusterName\":\"DEFAULT\",\"serviceName\":\"DEFAULT_GROUP@@promotion-service\",\"metadata\":{\"preserved.register.source\":\"SPRING_CLOUD\"},\"instanceHeartBeatInterval\":5000,\"instanceHeartBeatTimeOut\":15000,\"ipDeleteTimeout\":30000}],\"lastRefTime\":1743581371497,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":13800440376997} from /192.168.150.101
16:09:31.484-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [g.push.receiver] com.alibaba.nacos.client.naming          : new ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
16:09:31.491-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
16:09:32.108-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.cloud.commons.util.InetUtils         : Cannot determine local hostname
16:09:32.253-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Attempting to connect to: [192.168.150.101:5672]
16:09:32.271-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] o.s.a.r.c.CachingConnectionFactory       : Created new connection: rabbitConnectionFactory#c555e1e:0/SimpleConnection@56d9ef05 [delegate=amqp://tjxt@192.168.150.101:5672//tjxt, localPort= 57013]
16:09:32.305-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.tianji.promotion.PromotionApplication  : Started PromotionApplication in 8.615 seconds (JVM running for 9.06)
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service-local.yaml+DEFAULT_GROUP
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service-local.yaml, group=DEFAULT_GROUP, cnt=1
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service-local.yaml, group=DEFAULT_GROUP
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service+DEFAULT_GROUP
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service, group=DEFAULT_GROUP, cnt=1
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service, group=DEFAULT_GROUP
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.n.client.config.impl.ClientWorker    : [fixed-192.168.150.101_8848] [subscribe] promotion-service.yaml+DEFAULT_GROUP
16:09:32.307-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]-- INFO 10352 --- [ntContainer#0-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
16:09:32.307-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.nacos.client.config.impl.CacheData   : [fixed-192.168.150.101_8848] [add-listener] ok, tenant=, dataId=promotion-service.yaml, group=DEFAULT_GROUP, cnt=1
16:09:32.308-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.a.c.n.refresh.NacosContextRefresher    : listening config: dataId=promotion-service.yaml, group=DEFAULT_GROUP
16:09:32.308-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [           main] c.tianji.promotion.PromotionApplication  : --/
---------------------------------------------------------------------------------------
	Application 'promotion-service' is running! Access URLs:
	Local: 		http://localhost:8091
	External: 	http://192.168.150.1:8091
	Profile(s): 	[local]
---------------------------------------------------------------------------------------
16:09:32.409-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]-- INFO 10352 --- [ntContainer#0-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
16:09:32.424-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:09:32.433-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:09:32.445-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:09:32.451-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:09:32.452-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:09:32.453-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:09:43.852-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:09:43.854-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907344683072229378(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:09:32.453477300(LocalDateTime), 2025-04-12T16:09:32.453477300(LocalDateTime)
16:09:43.855-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:09:43.871-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:09:43.873-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), 2(Long), 11696(Integer)
16:09:43.874-[DESKTOP-FSAK1AQ][53699e66550a4a4e8a4d35b67647f6df]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : <==    Updates: 1
16:09:51.852-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [nio-8091-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
16:09:51.852-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [nio-8091-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
16:09:51.853-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [nio-8091-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
16:09:51.950-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:09:51.951-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:09:51.952-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:09:51.955-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:09:51.956-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:09:51.957-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 2
16:09:51.960-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? , ? )
16:09:51.960-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long), 1907339178157277186(Long)
16:09:51.963-[DESKTOP-FSAK1AQ][8676d2a1c6f240ae92d9f11cfdc48767]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 2
16:09:59.506-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [nio-8091-exec-2] c.t.c.autoconfigure.mq.RabbitMqHelper    : 准备发送消息，exchange：promotion.topic， RoutingKey：coupon_receive， message：UserCouponDTO(userId=2, couponId=1907339178157277186, serialNum=11692)
16:09:59.516-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:09:59.517-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:09:59.519-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:09:59.519-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:09:59.519-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:09:59.519-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:09:59.520-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:09:59.521-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907344748750835713(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:09:59.520271500(LocalDateTime), 2025-04-12T16:09:59.520271500(LocalDateTime)
16:09:59.522-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:09:59.523-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:09:59.524-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), 2(Long), 11692(Integer)
16:09:59.524-[DESKTOP-FSAK1AQ][eae83018bfad4fc0acd9b0b05631dbb2]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : <==    Updates: 1
16:09:59.527-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:09:59.527-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:09:59.527-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:09:59.528-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:09:59.529-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:09:59.530-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 3
16:09:59.530-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? , ? , ? )
16:09:59.530-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long), 1907339178157277186(Long), 1907339178157277186(Long)
16:09:59.531-[DESKTOP-FSAK1AQ][62a357e4f4ce41f79d3a0d46560db905]--DEBUG 10352 --- [nio-8091-exec-3] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 2
16:10:01.962-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:10:01.962-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:10:01.963-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:10:01.964-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:10:01.965-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:10:01.965-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 3
16:10:01.966-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? , ? , ? )
16:10:01.967-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long), 1907339178157277186(Long), 1907339178157277186(Long)
16:10:01.967-[DESKTOP-FSAK1AQ][74dbcb2f325441e29d3869fa71523b4c]--DEBUG 10352 --- [nio-8091-exec-4] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 2
16:10:43.040-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:10:43.041-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:10:43.042-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:10:43.043-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:10:43.043-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:10:43.044-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 1
16:10:43.044-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? )
16:10:43.045-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long)
16:10:43.045-[DESKTOP-FSAK1AQ][a8efea9eee83491391b96c08795393f1]--DEBUG 10352 --- [nio-8091-exec-5] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 1
16:11:16.749-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [nio-8091-exec-6] c.t.c.autoconfigure.mq.RabbitMqHelper    : 准备发送消息，exchange：promotion.topic， RoutingKey：coupon_receive， message：UserCouponDTO(userId=2, couponId=1907339178157277186, serialNum=11691)
16:11:16.753-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id=?
16:11:16.753-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : ==> Parameters: 1907339178157277186(Long)
16:11:16.755-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.CouponMapper.selectById     : <==      Total: 1
16:11:16.755-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==>  Preparing: update coupon set issue_num = issue_num + 1 where id = ? and issue_num < total_num
16:11:16.755-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : ==> Parameters: 1907339178157277186(Long)
16:11:16.756-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.m.CouponMapper.updateIssueNum      : <==    Updates: 1
16:11:16.757-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==>  Preparing: INSERT INTO user_coupon ( id, user_id, coupon_id, term_begin_time, term_end_time ) VALUES ( ?, ?, ?, ?, ? )
16:11:16.757-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : ==> Parameters: 1907345072685322242(Long), 2(Long), 1907339178157277186(Long), 2025-04-02T16:11:16.756524200(LocalDateTime), 2025-04-12T16:11:16.756524200(LocalDateTime)
16:11:16.757-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.UserCouponMapper.insert     : <==    Updates: 1
16:11:16.758-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==>  Preparing: UPDATE exchange_code SET status=?,user_id=? WHERE (id = ?)
16:11:16.758-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : ==> Parameters: 2(Integer), 2(Long), 11691(Integer)
16:11:16.759-[DESKTOP-FSAK1AQ][27c4cca7d6e447c0b8b5f05aaefaa002]--DEBUG 10352 --- [ntContainer#0-1] c.t.p.mapper.ExchangeCodeMapper.update   : <==    Updates: 1
16:11:16.767-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:11:16.767-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:11:16.768-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:11:16.769-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:11:16.769-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:11:16.770-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 2
16:11:16.770-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? , ? )
16:11:16.770-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long), 1907339178157277186(Long)
16:11:16.771-[DESKTOP-FSAK1AQ][2a547f3cd49f41b3a8dae6ce90ee428c]--DEBUG 10352 --- [nio-8091-exec-7] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 2
16:11:27.765-[DESKTOP-FSAK1AQ][37615fa1f61f464c8580b20ac43b84cb]--ERROR 10352 --- [nio-8091-exec-8] c.t.c.a.m.advice.CommonExceptionAdvice   : 自定义异常 -> com.tianji.common.exceptions.BadRequestException , 状态码：400, 异常原因：超出领取数量  
16:11:27.767-[DESKTOP-FSAK1AQ][37615fa1f61f464c8580b20ac43b84cb]--DEBUG 10352 --- [nio-8091-exec-8] c.t.c.a.m.advice.CommonExceptionAdvice   : 
com.tianji.common.exceptions.BadRequestException: 超出领取数量
	at com.tianji.promotion.service.impl.UserCouponServiceImpl.exchangeCodeUserCoupon(UserCouponServiceImpl.java:195) ~[classes/:na]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$FastClassBySpringCGLIB$$d325a33a.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.common.autoconfigure.redisson.aspect.LockAspect.handleLock(LockAspect.java:54) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.22.jar:5.3.22]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.22.jar:5.3.22]
	at com.tianji.promotion.service.impl.UserCouponServiceImpl$$EnhancerBySpringCGLIB$$109c007c.exchangeCodeUserCoupon(<generated>) ~[classes/:na]
	at com.tianji.promotion.controller.UserCouponController.exchangeCodeUserCoupon(UserCouponController.java:38) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1070) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.3.22.jar:5.3.22]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) ~[tomcat-embed-core-9.0.65.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.22.jar:5.3.22]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.22.jar:5.3.22]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at com.tianji.common.filters.RequestIdFilter.doFilter(RequestIdFilter.java:26) ~[classes/:na]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:360) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:890) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1789) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.65.jar:9.0.65]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
16:11:30.166-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:11:30.167-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:11:30.167-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:11:30.167-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:11:30.168-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:11:30.169-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 2
16:11:30.172-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? , ? )
16:11:30.172-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long), 1907339178157277186(Long)
16:11:30.173-[DESKTOP-FSAK1AQ][cccaec1f2ab045cf96ab8a1215b9d3f9]--DEBUG 10352 --- [nio-8091-exec-9] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 2
16:13:36.864-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : ==>  Preparing: SELECT COUNT(*) FROM user_coupon WHERE (user_id = ? AND status = ?)
16:13:36.864-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : ==> Parameters: 2(Long), 1(Integer)
16:13:36.865-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.U.selectPage_mpCount             : <==      Total: 1
16:13:36.865-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : ==>  Preparing: SELECT id,user_id,coupon_id,term_begin_time,term_end_time,used_time,status,create_time,update_time FROM user_coupon WHERE (user_id = ? AND status = ?) LIMIT ?
16:13:36.865-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : ==> Parameters: 2(Long), 1(Integer), 200(Long)
16:13:36.866-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.UserCouponMapper.selectPage      : <==      Total: 2
16:13:36.867-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : ==>  Preparing: SELECT id,`name`,type,discount_type,`specific`,discount_value,threshold_amount,max_discount_amount,obtain_way,issue_begin_time,issue_end_time,term_days,term_begin_time,term_end_time,status,total_num,issue_num,used_num,user_limit,ext_param,create_time,update_time,creater,updater FROM coupon WHERE id IN ( ? , ? )
16:13:36.867-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : ==> Parameters: 1906935008178790402(Long), 1907339178157277186(Long)
16:13:36.869-[DESKTOP-FSAK1AQ][a5d0e3ba5f024fd2b95c892f14759f86]--DEBUG 10352 --- [nio-8091-exec-1] c.t.p.m.CouponMapper.selectBatchIds      : <==      Total: 2
20:25:12.222-[DESKTOP-FSAK1AQ][sys]-- WARN 10352 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Start destroying common HttpClient
20:25:12.222-[DESKTOP-FSAK1AQ][sys]-- WARN 10352 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Start destroying Publisher
20:25:12.222-[DESKTOP-FSAK1AQ][sys]-- WARN 10352 --- [      Thread-19] c.a.nacos.common.notify.NotifyCenter     : [NotifyCenter] Destruction of the end
20:25:12.223-[DESKTOP-FSAK1AQ][sys]-- WARN 10352 --- [       Thread-1] c.a.n.common.http.HttpClientBeanHolder   : [HttpClientBeanHolder] Destruction of the end
20:25:12.236-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Waiting for workers to finish.
20:25:13.185-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ntContainer#0-2] o.s.a.r.l.SimpleMessageListenerContainer : Successfully waited for workers to finish.
20:25:13.349-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [      Thread-12] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server stop.
20:25:13.352-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job registry-remove success, registryParam:RegistryParam{registryGroup='EXECUTOR', registryKey='promotion-service', registryValue='http://192.168.150.1:9999/'}, registryResult:ReturnT [code=200, msg=null, content=null]
20:25:13.352-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [rRegistryThread] c.x.j.c.thread.ExecutorRegistryThread    : >>>>>>>>>>> xxl-job, executor registry thread destroy.
20:25:13.352-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.xxl.job.core.server.EmbedServer      : >>>>>>>>>>> xxl-job remoting server destroy success.
20:25:13.352-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [FileCleanThread] c.x.j.core.thread.JobLogFileCleanThread  : >>>>>>>>>>> xxl-job, executor JobLogFileCleanThread thread destroy.
20:25:13.354-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [rCallbackThread] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor callback thread destroy.
20:25:13.354-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [      Thread-11] c.x.j.core.thread.TriggerCallbackThread  : >>>>>>>>>>> xxl-job, executor retry callback thread destroy.
20:25:13.354-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registering from Nacos Server now...
20:25:13.354-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [BEAT] removing beat: DEFAULT_GROUP@@promotion-service:192.168.150.1:8091 from beat map.
20:25:13.354-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [DEREGISTER-SERVICE] f923fb34-cb0a-4c06-8fca-ad61ea61a3f0 deregistering service DEFAULT_GROUP@@promotion-service with instance: Instance{instanceId='null', ip='192.168.150.1', port=8091, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
20:25:13.356-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] c.a.c.n.registry.NacosServiceRegistry    : De-registration finished.
20:25:13.356-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown begin
20:25:13.450-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.beat.BeatReactor do shutdown stop
20:25:13.450-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown begin
20:25:13.867-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [g.push.receiver] com.alibaba.nacos.client.naming          : received push data: {"type":"dom","data":"{\"name\":\"DEFAULT_GROUP@@promotion-service\",\"clusters\":\"DEFAULT\",\"cacheMillis\":10000,\"hosts\":[],\"lastRefTime\":1743596713923,\"checksum\":\"\",\"allIPs\":false,\"reachProtectionThreshold\":false,\"valid\":true}","lastRefTime":29142866561616} from /192.168.150.101
20:25:13.868-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [g.push.receiver] com.alibaba.nacos.client.naming          : removed ips(1) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> [{"instanceId":"192.168.150.1#8091#DEFAULT#DEFAULT_GROUP@@promotion-service","ip":"192.168.150.1","port":8091,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@promotion-service","metadata":{"preserved.register.source":"SPRING_CLOUD"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
20:25:13.874-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [g.push.receiver] com.alibaba.nacos.client.naming          : current ips:(0) service: DEFAULT_GROUP@@promotion-service@@DEFAULT -> []
20:25:16.453-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown begin
20:25:19.472-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.PushReceiver do shutdown stop
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.core.HostReactor do shutdown stop
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown begin
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- WARN 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Start destroying NacosRestTemplate
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- WARN 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : [NamingHttpClientManager] Destruction of the end
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] c.a.n.client.identify.CredentialWatcher  : [null] CredentialWatcher is stopped
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] c.a.n.client.identify.CredentialService  : [null] CredentialService is freed
20:25:19.473-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.alibaba.nacos.client.naming          : com.alibaba.nacos.client.naming.net.NamingProxy do shutdown stop
20:25:19.506-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] o.s.a.r.l.SimpleMessageListenerContainer : Shutdown ignored - container is already stopped
20:25:19.630-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
20:25:19.642-[DESKTOP-FSAK1AQ][sys]-- INFO 10352 --- [ionShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
